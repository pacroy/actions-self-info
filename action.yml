name: 'Composite Action Info'
description: 'Display information about this composite action'

runs:
  using: "composite"
  steps:
    - name: 'Print Context Variables'
      shell: bash
      run: |
        #============================== Print Context Variables ==============================
        function print_variable {
          echo '::group::$1'
          echo "$2"
          echo '::endgroup::'
          {
        cat <<EOF
        <details>
        <summary>$1</summary>

        \`\`\`json
        $2
        \`\`\`

        </details>

        EOF
          } >> "$GITHUB_STEP_SUMMARY"
        }

        { 
          echo '# Context Variables'
          echo
        } >> "$GITHUB_STEP_SUMMARY"

        print_variable 'github' '${{ toJSON(github) }}'
        print_variable 'env' '${{ toJSON(env) }}'
        print_variable 'job' '${{ toJSON(job) }}'
        print_variable 'steps' '${{ toJSON(steps) }}'
        print_variable 'runner' '${{ toJSON(runner) }}'
        print_variable 'strategy' '${{ toJSON(strategy) }}'
        print_variable 'matrix' '${{ toJSON(matrix) }}'
        print_variable 'inputs' '${{ toJSON(inputs) }}'

    - name: 'Print JS Objects'
      uses: actions/github-script@v6
      with:
        script: |
          core.info('============================== Print JS Objects ==============================')

          core.info('::group::github')
          core.info(JSON.stringify(github, null, 4))
          core.info('::endgroup::')

          const contextAttrs = JSON.stringify(context, null, 4)
          core.info('::group::context')
          core.info(contextAttrs)
          core.info('::endgroup::')
          await core.summary.addRaw(`
          # JavaScript Objects

          <details>
          <summary>context</summary>

          \`\`\`json
          ${contextAttrs}
          \`\`\`

          </details>
          `).write()

          core.info('::group::core')
          core.info(JSON.stringify(core, null, 4))
          core.info('::endgroup::')

          core.info('::group::glob')
          core.info(JSON.stringify(glob, null, 4))
          core.info('::endgroup::')

          core.info('::group::io')
          core.info(JSON.stringify(io, null, 4))
          core.info('::endgroup::')

          core.info('::group::exec')
          core.info(JSON.stringify(exec, null, 4))
          core.info('::endgroup::')